#PS Script to gather information about the local machine then create a CSV with that information in a specific directory
$infoblock = {
       $csinfo = GetWMIObject Win32_ComputerSystem | Select-Object -Property Name, Domain, Manufacturer, Model;
       $biosinfo = GetWMIObject Win32_BIOS | Select-Object -Property SerialNumber;
       $netadapter = GetWMIObject Win32_NetworkAdapterConfiguration | Where-Object {$_.DefaultIPGateWay -ne $null} | Select-Object -Property IPAdress, IPSubnet, DefaultIPGateway, MACAddress, Description;
       $osinfo = GetWMIObject Win32_OperatingSystem | Select-Object -Property Caption, Version;
       $hddinfo = GetWMIObject Win32_PhysicalMedia | Where-Object {$_.SerialNumber -ne $null} | Select-Object -Property SerialNumber;
       $output = New-Object PSObject -Property @{
              'Name' = $csinfo.name
              'Domain' = $csinfo.domain
              'Manufacturer' = $csinfo.manufacturer
              'Model' = $csinfo.model
              'Serial Number' = $biosinfo.serialnumber
              'IP Address' = $netadapter.ipaddress[0]
              'Subnet Mask' = $netadapter.ipsubnet[0]
              'Default Gateway' = $netadapter.defaultipgateway[0]
              'MAC' = $netadapter.macaddress
              'NIC Type' = $netadapter.description
              'OS' = $osinfo.caption
              'Version' = $osinfo.version
              'Storage Drive Serial' = $hddinfo.serialnumber.replace('\s','').replace('.','').replace('_','-')
              };
       $output
       };
New-Item -ItemType 'directory' -Path 'C:\DeviceInfo\' -ErrorAction 'silentlycontinue';
& $infoblock | Select-Object -Property 'Name','Domain','OS','Version','Manufacturer','Model','Serial Number','Storage Drive Serial','IP Address','Subnet Mask','Default Gateway','MAC','NIC Type' | ConvertTo-CSV -NoTypeInformation | Out-File -FilePath "C:\DeviceInfo\$env:COMPUTERNAME.csv"
